{% extends 'base.html' %}
{% block title %}Show Recipes Base Template{% endblock %}

{% block content %}

{% block filter_recipes %}
{% endblock %}

{% block user_favorites %}
{% endblock %}

{% if recipes %}
<div class="row">

{% for recipe in recipes %}
<div class="col-sm-3 card-deck mb-3">
<div class="card recipe-card">
    <a href="{{ url_for('recipe_info', id=recipe.id) }}"><img class="card-img-top recipes-image" src="{{ recipe.image_url }}" alt="Card image cap"></a>
    <div class="card-body">
      <a href="{{ url_for('recipe_info', id=recipe.id) }}"><h6 class="card-title text-dark text-uppercase">{{ recipe.title }}</h6></a>
      <div class="mb-2">
        {% if recipe.score %}
        <span class="badge rounded-pill bg-success">{{ recipe.score }}%</span>
        {% endif %}
        {% if recipe.tags %}
          {% for tag in recipe.tags %}
          <span class="badge bg-light text-dark text-uppercase">{{ tag }}</span>
          {% endfor %}
          {% endif %}
      </div>
      {% if recipe.summary %}
      <p class="lh-sm fw-light fs-6">{{ recipe.summary[0:80] }}...</p>
      {% endif %}

        {% if g.user %}

            <div class="row">
                <form class="recipe-form" method="POST">
                    <button id="heart" class="btn btn-lg btn-link bi bi-heart-fill
                      {{'fav' if recipe in g.user.favorites else 'not-fav'}}" data-id="{{ recipe.id }}">
                    <!-- {% if recipe.favorites %} -->
                        <!-- <span class="fav-count">{{ recipe.favs() }}</span> -->
                    <!-- {% endif %} -->
                    </button>
  
                    <div class="btn-group lists-btn">
                        <button type="button" class="btn btn-link btn-lg p-0" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-bookmark-plus-fill"></i>
                        </button>
                        <ul class="dropdown-menu">
                        {% for list in g.user.lists %}
                            {% if not list.has_recipe(recipe.id) %}
                            <li data-list="{{ list.id }}" data-recipe="{{ recipe.id }}" class="dropdown-item">
                              {{ list.name }}
                            </li>
                            {% else %}
                            {% endif %}
                        {% endfor %}
                        </ul>
                    </div>
                </form>
            </div>
            {% endif %}
    </div>
  </div>
</div>
{% endfor %}
</div>

    {% else %}
    <p>Sorry, we couldn't find any recipes that matched.</p>
{% endif %}
    
{% endblock %}